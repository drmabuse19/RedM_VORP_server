"use strict";!function(a){window.dialog={defaultParams:{title:"",message:"",button:"Ok",cancel:"Cancel",item:"",type:"",required:!1,select:!1,position:"fixed",animation:"scale",input:{type:"text"},validate:function(a,b,c){},callback:function(a){}},transitionEnd:"transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",alert:function(b){dialog.appendDialogHolder(),b=a.extend(!0,{},dialog.defaultParams,b);let e=dialog.generateRandomId(),c='<div class="dialog-alert" id="'+e+'">';c+='<div class="dialog-border"></div>',c+='<div class="dialog-title">'+b.title+"</div>",c+='<div class="dialog-message">'+b.message+"</div>",c+='<div class="dialog-close">&times;</div>',c+='<div class="dialog-confirm">'+b.button+"</div>",c+='<div class="dialog-clearFloat"></div>',c+="</div>",dialog.holder.find("td").append(c);let d=a("#"+e),g=d.find(".dialog-confirm"),f=d.find(".dialog-close");!0===b.required&&f.remove(),d.attr("data-dialog-position",b.position),d.attr("data-dialog-animation",b.animation),dialog.injectDialog(),g.one("click.dialog",function(){b.callback(!0)}),f.one("click.dialog",function(){b.callback(null)})},prompt:function(b){let e;dialog.appendDialogHolder(),b=a.extend(!0,{},dialog.defaultParams,b);let f=dialog.generateRandomId(),g="";for(let h in b.input)g+=" "+h+'="'+b.input[h]+'" ';let c='<div class="dialog-alert" id="'+f+'">';c+='<div class="dialog-border"></div>',c+='<div class="dialog-title">'+b.title+"</div>",c+='<div class="dialog-message">'+b.message+"</div>",b.select?b.item.players.forEach(function(a){c+='<div class="select" data-player="'+a.player+'">'+a.label+"</div>"}):c+="<label><input "+g+" /></label>",c+='<div class="dialog-close">&times;</div>',b.select||(c+='<div class="dialog-confirm">'+b.button+"</div>"),c+='<div class="dialog-clearFloat"></div>',c+="</div>",dialog.holder.find("td").append(c);let d=a("#"+f);e=b.select?d.find(".select"):d.find(".dialog-confirm");let i=d.find(".dialog-close"),j=d.find("input");!0===b.required&&i.remove(),d.attr("data-dialog-position",b.position),d.attr("data-dialog-animation",b.animation),dialog.injectDialog(),e.bind("click.dialog",function(){let c=j.val();if(b.select?b.validate(c,b.item,a(this).data("player")):b.validate(c,b.item,b.type),!0===b.required&&""===c)return d.one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(a){d.removeClass("dialog-shaking")}).addClass("dialog-shaking");b.callback(c)}),i.one("click.dialog",function(){b.callback(null)})},confirm:function(b){dialog.appendDialogHolder(),b=a.extend(!0,{},dialog.defaultParams,b);let e=dialog.generateRandomId(),c='<div class="dialog-alert" id="'+e+'">';c+='<div class="dialog-border"></div>',c+='<div class="dialog-title">'+b.title+"</div>",c+='<div class="dialog-message">'+b.message+"</div>",c+='<div class="dialog-close">&times;</div>',c+='<div class="dialog-cancel">'+b.cancel+"</div>",c+='<div class="dialog-confirm">'+b.button+"</div>",c+='<div class="dialog-clearFloat"></div>',c+="</div>",dialog.holder.find("td").append(c);let d=a("#"+e),g=d.find(".dialog-confirm"),h=d.find(".dialog-cancel"),f=d.find(".dialog-close");!0===b.required&&f.remove(),d.attr("data-dialog-position",b.position),d.attr("data-dialog-animation",b.animation),dialog.injectDialog(),g.one("click.dialog",function(){b.callback(!0)}),h.one("click.dialog",function(){b.callback(!1)}),f.one("click.dialog",function(){b.callback(null)})},generateRandomId:function(){return Math.floor(1e6*Math.random())+1+(new Date).getTime()},showDialog:function(){a(":focus").blur();let b=a(".dialog-alert:first");"absolute"===b.attr("data-dialog-position")?(dialog.holder.removeClass("dialog-fixed"),dialog.holder.css("top",a(window).scrollTop())):(dialog.holder.addClass("dialog-fixed"),dialog.holder.css("top","")),a(window).trigger("resize.dialog"),a(".dialog-alert").hide(),b.show(),setTimeout(function(){b.bind(dialog.transitionEnd,function(c){a(c.target).is(this)&&(b.unbind(dialog.transitionEnd),dialog.focusElement(b.find("input")[0],!0))}).addClass("dialog-visible")},1),a("html").addClass("dialogIsVisible")},injectDialog:function(){0===a(".dialog-alert:visible").length?dialog.showDialog():a(".dialog-alert:last").hide(),dialog.overlay.addClass("dialog-visible")},focusElement:function(b,c){b&&(a(b).one("blur.dialog",function(){dialog.focusElement(b,!1)}),b.focus(),c&&(b.scrollLeft=b.scrollWidth))},appendDialogHolder:function(){dialog.holder||(a("body").append('<div id="dialog-overlay"></div><div id="dialog-holder"><table id="dialog-center"><tr><td></td></tr></table></div>'),dialog.overlay=a("#dialog-overlay"),dialog.holder=a("#dialog-holder"),dialog.bindDialogGlobalEvents(),a("html").addClass("dialogHolderIsVisible"))},removeDialogHolder:function(){dialog.unbindDialogGlobalEvents(),dialog.overlay.remove(),dialog.holder.remove(),dialog.overlay=void 0,dialog.holder=void 0,a("html").removeClass("dialogHolderIsVisible")},close:function(){let b=a(".dialog-alert:not(.dialog-closing):first");b.addClass("dialog-closing").bind(dialog.transitionEnd,function(c){a(c.target).is(this)&&(b.unbind(dialog.transitionEnd),b.remove(),a("html").removeClass("dialogIsVisible"),0===a(".dialog-alert").length?dialog.overlay.addClass("dialog-closing").bind(dialog.transitionEnd,function(b){a(b.target).is(this)&&(dialog.overlay.unbind(dialog.transitionEnd),dialog.removeDialogHolder())}).removeClass("dialog-visible"):dialog.showDialog())}).removeClass("dialog-visible")},bindDialogGlobalEvents:function(){dialog.holder.add(dialog.overlay).bind("click.dialog",function(b){a(b.target).closest(".dialog-alert").is(".dialog-alert")||a(".dialog-close:visible").trigger("click")}),a(document).on("click.dialog",".dialog-confirm, .dialog-cancel, .dialog-close, .select",function(a){return dialog.close()}),a(document).bind("keyup.dialog",function(b){27===b.keyCode&&a(".dialog-alert").is(":visible")&&a(".dialog-close:visible").trigger("click")}),a(document).bind("keydown.dialog",function(c){let b=a(".dialog-alert:visible");if(0!==b.length)return 13===c.keyCode?b.find(".dialog-confirm").trigger("click"):void 0}),a(window).bind("resize.dialog",function(){dialog.overlay.height("100%"),dialog.overlay.height(a(document).height())})},unbindDialogGlobalEvents:function(){dialog.overlay.off(".dialog"),dialog.holder.off(".dialog"),a(document).off(".dialog"),a(window).off(".dialog")}}}(jQuery)